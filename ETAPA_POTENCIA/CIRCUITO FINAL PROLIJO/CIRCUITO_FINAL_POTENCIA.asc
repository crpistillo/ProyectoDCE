Version 4
SHEET 1 3216 2012
WIRE -2080 -464 -2080 -528
WIRE -2656 -448 -2656 -464
WIRE -2528 -448 -2528 -496
WIRE -2416 -448 -2416 -496
WIRE -2256 -448 -2256 -496
WIRE -2080 -320 -2080 -384
WIRE -2528 -304 -2528 -368
WIRE -2416 -304 -2416 -368
WIRE -2256 -304 -2256 -368
WIRE -1296 -16 -1344 -16
WIRE -1200 0 -1232 0
WIRE 480 0 208 0
WIRE 800 0 704 0
WIRE 816 0 800 0
WIRE 992 0 896 0
WIRE 1200 0 992 0
WIRE 1424 0 1264 0
WIRE 1536 0 1424 0
WIRE -1296 16 -1328 16
WIRE -240 16 -352 16
WIRE 992 16 992 0
WIRE -240 80 -240 16
WIRE -208 80 -240 80
WIRE -768 96 -800 96
WIRE -96 96 -96 48
WIRE -96 96 -144 96
WIRE 192 96 -96 96
WIRE 480 96 192 96
WIRE 896 96 704 96
WIRE 992 96 896 96
WIRE -624 112 -704 112
WIRE -384 112 -624 112
WIRE -208 112 -384 112
WIRE 1424 112 1424 0
WIRE 1536 112 1536 0
WIRE -1488 128 -1776 128
WIRE -1328 128 -1328 16
WIRE -1328 128 -1408 128
WIRE -1296 128 -1328 128
WIRE -1200 128 -1200 0
WIRE -1200 128 -1216 128
WIRE -1152 128 -1200 128
WIRE -944 128 -1072 128
WIRE -864 128 -944 128
WIRE -768 128 -864 128
WIRE 992 128 992 96
WIRE 800 144 800 0
WIRE -176 176 -176 128
WIRE 480 192 352 192
WIRE 1200 192 704 192
WIRE 1344 192 1280 192
WIRE 1376 192 1344 192
WIRE 352 208 352 192
WIRE 896 208 896 96
WIRE 1344 208 1344 192
WIRE -864 224 -864 128
WIRE -784 224 -864 224
WIRE -624 224 -624 112
WIRE -624 224 -704 224
WIRE 992 240 992 208
WIRE 352 288 352 272
WIRE 480 288 352 288
WIRE 800 288 800 224
WIRE 800 288 704 288
WIRE 896 288 896 272
WIRE 896 288 800 288
WIRE 1344 288 1344 272
WIRE 1344 288 896 288
WIRE 1424 288 1424 208
WIRE 1424 288 1344 288
WIRE 1536 288 1536 176
WIRE 1536 288 1424 288
WIRE 1712 288 1536 288
WIRE 1888 288 1792 288
WIRE 2064 288 1888 288
WIRE 2144 288 2064 288
WIRE 352 304 352 288
WIRE 1888 320 1888 288
WIRE 2144 320 2144 288
WIRE -864 352 -864 224
WIRE -768 352 -864 352
WIRE -624 352 -624 224
WIRE -624 352 -704 352
WIRE 480 384 352 384
WIRE 816 384 704 384
WIRE 896 384 816 384
WIRE 992 384 992 304
WIRE 992 384 896 384
WIRE 1024 384 992 384
WIRE 1424 400 1424 288
WIRE 1888 432 1888 384
WIRE 2144 432 2144 400
WIRE 1536 448 1536 288
WIRE 352 480 352 464
WIRE 480 480 352 480
WIRE 1200 480 704 480
WIRE 1344 480 1280 480
WIRE 1376 480 1344 480
WIRE 896 496 896 384
WIRE 1344 496 1344 480
WIRE 816 528 816 384
WIRE 352 544 352 480
WIRE 1424 560 1424 496
WIRE 1424 560 1344 560
WIRE 480 576 432 576
WIRE 896 576 896 560
WIRE 896 576 704 576
WIRE 432 672 432 576
WIRE 816 672 816 608
WIRE 816 672 432 672
WIRE 816 688 816 672
WIRE 352 800 352 624
WIRE 352 800 320 800
WIRE 816 800 816 768
WIRE 816 800 352 800
WIRE 896 800 896 576
WIRE 896 800 816 800
WIRE 1424 800 1424 560
WIRE 1424 800 896 800
WIRE 1536 800 1536 512
WIRE 1536 800 1424 800
WIRE 576 1008 544 1008
WIRE 720 1008 656 1008
WIRE 800 1008 720 1008
WIRE 944 1008 880 1008
WIRE 720 1024 720 1008
WIRE -944 1088 -944 128
WIRE 544 1088 544 1008
WIRE 544 1088 -944 1088
WIRE 944 1088 944 1008
WIRE 2064 1088 2064 288
WIRE 2064 1088 944 1088
WIRE 544 1152 544 1088
WIRE 576 1152 544 1152
WIRE 800 1152 640 1152
WIRE 944 1152 944 1088
WIRE 944 1152 880 1152
FLAG -2416 -304 0
FLAG -2416 -496 VDD
FLAG -2256 -304 0
FLAG -2256 -496 Vcc
FLAG 1888 432 0
FLAG -2656 -368 0
FLAG -2528 -304 0
FLAG -2528 -496 Vss
FLAG -2656 -464 5V
FLAG -384 112 V_error
FLAG -736 80 Vss
FLAG -736 144 5V
FLAG -96 -32 5V
FLAG -176 176 Vss
FLAG -176 64 5V
FLAG -1344 -16 0
FLAG -1264 -32 Vss
FLAG -1264 32 5V
FLAG 320 800 0
FLAG 1424 0 VDD
FLAG 352 304 0
FLAG 1424 288 Vo1
FLAG 1024 384 Vcc
FLAG -800 96 0
FLAG -2080 -320 0
FLAG -2080 -528 Triangular
FLAG -352 16 Triangular
FLAG -1808 976 0
FLAG -1808 896 Vin
FLAG -1776 128 Vin
FLAG 208 0 Vcc
FLAG 192 96 PWM
FLAG 2144 432 0
FLAG 720 1088 0
SYMBOL voltage -2256 -464 R0
SYMATTR InstName V2
SYMATTR Value 15
SYMBOL voltage -2416 -464 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V4
SYMATTR Value 60
SYMBOL ind 1696 304 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName Lf
SYMATTR Value 2m
SYMBOL cap 1872 320 R0
SYMATTR InstName Cf
SYMATTR Value 1µ
SYMBOL voltage -2656 -464 R0
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V7
SYMATTR Value 5
SYMBOL voltage -2528 -464 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V8
SYMATTR Value -5
SYMBOL res 672 992 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value {R_2}
SYMBOL res 896 992 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value {R_1}
SYMBOL cap 736 1088 R180
WINDOW 0 -40 46 Left 2
WINDOW 3 -65 4 Left 2
SYMATTR InstName C3
SYMATTR Value {C_1}
SYMBOL cap 640 1136 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value {C_2}
SYMBOL res 896 1136 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value {R_3}
SYMBOL res -688 208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rp
SYMATTR Value {Rp}
SYMBOL cap -704 336 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName Cp
SYMATTR Value {Cp}
SYMBOL opamp2 -736 176 M180
SYMATTR InstName U4
SYMATTR Value TL084
SYMBOL opamp2 -176 32 R0
WINDOW 3 16 103 Left 2
SYMATTR Value LM393
SYMATTR InstName U5
SYMBOL res -112 -48 R0
SYMATTR InstName R14
SYMATTR Value 3k
SYMBOL res -1200 112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value {Rg}
SYMBOL res -1392 112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R23
SYMATTR Value {Rg}
SYMBOL res -1056 112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R24
SYMATTR Value {Rg}
SYMBOL opamp2 -1264 64 M180
WINDOW 3 21 85 Left 2
SYMATTR InstName U3
SYMATTR Value TL084
SYMBOL cap 880 208 R0
SYMATTR InstName C1
SYMATTR Value 22n
SYMBOL cap 336 208 R0
SYMATTR InstName Ct1
SYMATTR Value 10p
SYMBOL cap 880 496 R0
SYMATTR InstName C2
SYMATTR Value 22n
SYMBOL nmos 1376 112 R0
SYMATTR InstName M1
SYMATTR Value irf510
SYMATTR Prefix X
SYMBOL res 976 112 R0
WINDOW 0 37 25 Left 2
WINDOW 3 36 62 Left 2
SYMATTR InstName RD1
SYMATTR Value 0.1
SYMBOL res 1296 176 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RG1
SYMATTR Value 22
SYMBOL res 1296 464 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RG2
SYMATTR Value 22
SYMBOL res 784 128 R0
SYMATTR InstName R3
SYMATTR Value 3.3k
SYMBOL res 912 -16 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 6.8k
SYMBOL res 1008 112 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL res 336 528 R0
SYMATTR InstName R5
SYMATTR Value 5.6k
SYMBOL res 336 368 R0
SYMATTR InstName R4
SYMATTR Value 4.7k
SYMBOL IRS20954 592 288 R0
SYMATTR InstName X1
SYMBOL voltage -2080 -480 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 369 69 Right 2
WINDOW 0 42 39 Left 2
SYMATTR Value PULSE(-4 4 0 2.5u 2.5u 0 5u)
SYMATTR InstName V3
SYMBOL diode 1552 176 R180
WINDOW 0 -25 66 Left 2
WINDOW 3 -84 3 Left 2
SYMATTR InstName D6
SYMATTR Value MUR460
SYMBOL diode 1552 512 R180
WINDOW 0 -25 66 Left 2
WINDOW 3 -83 -3 Left 2
SYMATTR InstName D7
SYMATTR Value MUR460
SYMBOL diode 1200 16 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value BAV21
SYMBOL cap 1328 208 R0
SYMATTR InstName C9
SYMATTR Value 1n
SYMBOL cap 1328 496 R0
WINDOW 3 31 49 Left 2
SYMATTR InstName C10
SYMATTR Value 1n
SYMBOL diode 1008 304 R180
WINDOW 0 -26 61 Left 2
WINDOW 3 -79 -3 Left 2
SYMATTR InstName D1
SYMATTR Value 1N4448
SYMBOL res 800 672 R0
SYMATTR InstName R7
SYMATTR Value 3.3k
SYMBOL res 800 512 R0
SYMATTR InstName R6
SYMATTR Value 8.2k
SYMBOL voltage -1808 880 R0
SYMATTR InstName V5
SYMATTR Value SINE(1.033 1 100)
SYMBOL nmos 1376 400 R0
SYMATTR InstName M2
SYMATTR Value irf510
SYMATTR Prefix X
SYMBOL res 2160 416 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName RG4
SYMATTR Value 22
TEXT -2256 120 Left 2 ;Vb Zos: 220V\nVddZos: 210V\nVccZ: 20.2V\nVb Z: 20.2V\nVddZ: 10.4V\nTd on: 90ns+Tdt\nTd off: 90ns\nTsd:  < 1us\nTr on: 15ns\nTf off: 10ns\nTdt: 15/25/35/45ns\nVdt: .89/.57/.36/.23\nVHin: 2.3\nVLin: 1.5\nVHsat: 1.2\nRos: 5e6\nRb: 12k\nRcc: 7k\nRdd: 22k\nRin: 1e6\nUVL Vcc: 8.9/8.7V\nUVL Vb:  8.5/8.3V\nUVL Vdd: 8.7/8.2V\nIo+: 1.0A\nIo-: 1.2A\nVoc: 70/30 %Vdd\nIoc: +/-100ua\nOCH: 1.2Vos\n 300ns filter\nOCL: 0.0Vos\n 200ns filter
TEXT -2576 -168 Left 2 !.model MUR460 D(Is=149n Rs=.0384 N=2 EG=1.285 XTI=.5 BV=800 \n+ IBV=1e-05 Cjo=126.4p Vj=1.34 M=.52 tt=44.4n Iave=4 Vpk=600 mfg=GI type=silicon)
TEXT -2576 -104 Left 2 !.MODEL BAV21W D  ( IS=1.09u RS=0.105 BV=200 IBV=100n\n+ CJO=5.00p  M=0.333 N=3.29 TT=72.0n )
TEXT -1976 1240 Left 2 !.include LM393.5_1
TEXT -1976 1280 Left 2 !.include TL084.301
TEXT -1520 -64 Left 2 !.param Rg=10k
TEXT -1984 1176 Left 2 !.MODEL BAV21 D  ( IS=1.09u RS=0.105 BV=200 IBV=100n\n+ CJO=5.00p  M=0.333 N=3.29 TT=72.0n )
TEXT -1992 1096 Left 2 !.MODEL 1N4448 D (IS=2.22E-10 N=1.70 BV=1.00E+02 IBV=5.00E-05\n+ RS=2.10E-01 CJO=4.00E-12 VJ=.75 M=.333 TT=5.76E-09)
TEXT -1976 1328 Left 2 !.include irf510.lib.txt
TEXT 576 1232 Left 2 !.param R_1=50k R_2=250k \n+ R_3=1k C_1=10p C_2=0.15n
TEXT -1520 -104 Left 2 ;Amplificador inversor
TEXT -864 440 Left 2 !.param Rp=220k Cp=1p
TEXT -888 -24 Left 2 ;Amplificador relimentado por \ncorriente con compensador PID
TEXT -304 -104 Left 2 ;Comparador
TEXT 704 -112 Left 2 ;Half bridge con Gate Driver
TEXT 616 928 Left 2 ;Bloque realimentador f
TEXT -1600 384 Left 2 !.tran 0 100m 0 1m uic
RECTANGLE Normal -1536 -84 -1016 200 2
RECTANGLE Normal -888 24 -564 472 2
RECTANGLE Normal -312 -80 20 224 2
RECTANGLE Normal 252 -88 1656 836 2
RECTANGLE Normal 508 948 984 1280 2
