Version 4
SHEET 1 3216 1408
WIRE 1168 -848 1152 -848
WIRE 1760 -816 1648 -816
WIRE 1984 -816 1840 -816
WIRE 736 -784 560 -784
WIRE 1120 -784 816 -784
WIRE 1120 -768 1120 -784
WIRE 1136 -768 1120 -768
WIRE 1248 -752 1248 -800
WIRE 1248 -752 1200 -752
WIRE 1312 -752 1248 -752
WIRE 1136 -736 896 -736
WIRE 1504 -736 1424 -736
WIRE 1648 -736 1648 -816
WIRE 1648 -736 1584 -736
WIRE 1168 -672 1168 -720
WIRE 1648 -672 1648 -736
WIRE 1760 -672 1648 -672
WIRE 1920 -656 1824 -656
WIRE 1984 -656 1984 -816
WIRE 1984 -656 1920 -656
WIRE 1312 -640 1312 -752
WIRE 1552 -640 1312 -640
WIRE 1696 -640 1632 -640
WIRE 1760 -640 1696 -640
WIRE 736 -576 688 -576
WIRE 896 -576 896 -736
WIRE 896 -576 816 -576
WIRE 1696 -544 1696 -640
WIRE 1792 -544 1696 -544
WIRE 1984 -544 1984 -656
WIRE 1984 -544 1872 -544
WIRE 1696 -528 1696 -544
WIRE 688 -512 688 -576
WIRE 896 -448 896 -576
WIRE 1024 -448 896 -448
WIRE 1312 -448 1312 -640
WIRE 1312 -448 1104 -448
WIRE 1696 -416 1696 -464
WIRE 560 -384 560 -784
WIRE 1984 -384 1984 -544
WIRE 1984 -384 560 -384
WIRE -496 -352 -496 -400
WIRE -384 -352 -384 -400
WIRE -224 -352 -224 -400
WIRE 48 -352 48 -400
WIRE 400 -352 400 -400
WIRE -496 -208 -496 -272
WIRE -384 -208 -384 -272
WIRE -224 -208 -224 -272
WIRE 48 -208 48 -272
WIRE 400 -208 400 -272
WIRE 1136 -144 1104 -144
WIRE 1248 -144 1200 -144
WIRE -928 -112 -1440 -112
WIRE -656 -112 -848 -112
WIRE 1248 -96 1248 -144
WIRE -656 -80 -656 -112
WIRE -1216 -16 -1264 -16
WIRE -1120 0 -1152 0
WIRE -1216 16 -1248 16
WIRE -656 48 -656 0
WIRE -240 48 -288 48
WIRE 80 48 -16 48
WIRE 96 48 80 48
WIRE 272 48 176 48
WIRE 480 48 272 48
WIRE 704 48 544 48
WIRE 272 64 272 48
WIRE 1104 64 1104 -144
WIRE -544 80 -560 80
WIRE -800 96 -848 96
WIRE -432 96 -432 48
WIRE -432 96 -480 96
WIRE -656 112 -736 112
WIRE -544 112 -656 112
WIRE -1440 128 -1440 -112
WIRE -1408 128 -1440 128
WIRE -1248 128 -1248 16
WIRE -1248 128 -1328 128
WIRE -1216 128 -1248 128
WIRE -1120 128 -1120 0
WIRE -1120 128 -1136 128
WIRE -1056 128 -1120 128
WIRE -944 128 -976 128
WIRE -896 128 -944 128
WIRE -800 128 -896 128
WIRE -240 144 -288 144
WIRE 176 144 -16 144
WIRE 272 144 176 144
WIRE 704 160 704 48
WIRE -512 176 -512 128
WIRE 272 176 272 144
WIRE 80 192 80 48
WIRE 1504 208 1072 208
WIRE -896 224 -896 128
WIRE -816 224 -896 224
WIRE -656 224 -656 112
WIRE -656 224 -736 224
WIRE -240 240 -368 240
WIRE 480 240 -16 240
WIRE 656 240 560 240
WIRE -368 256 -368 240
WIRE 176 256 176 144
WIRE 272 288 272 256
WIRE -368 336 -368 320
WIRE -240 336 -368 336
WIRE 80 336 80 272
WIRE 80 336 -16 336
WIRE 176 336 176 320
WIRE 176 336 80 336
WIRE 704 336 704 256
WIRE 704 336 176 336
WIRE 816 336 704 336
WIRE 896 336 816 336
WIRE 1072 336 1072 208
WIRE 1072 336 976 336
WIRE 1152 336 1072 336
WIRE -896 352 -896 224
WIRE -800 352 -896 352
WIRE -656 352 -656 224
WIRE -656 352 -736 352
WIRE -368 352 -368 336
WIRE 1072 368 1072 336
WIRE -1440 416 -1440 288
WIRE -240 432 -368 432
WIRE 80 432 -16 432
WIRE 176 432 80 432
WIRE 272 432 272 352
WIRE 272 432 176 432
WIRE 304 432 272 432
WIRE 704 448 704 336
WIRE -896 464 -896 352
WIRE -752 464 -816 464
WIRE -656 464 -656 352
WIRE -656 464 -688 464
WIRE 704 464 704 448
WIRE 1072 464 1072 432
WIRE 1232 464 1232 336
WIRE 1232 464 1072 464
WIRE 1072 480 1072 464
WIRE -368 528 -368 512
WIRE -240 528 -368 528
WIRE 480 528 -16 528
WIRE 656 528 560 528
WIRE 176 560 176 432
WIRE 304 608 304 432
WIRE -240 624 -288 624
WIRE 176 624 -16 624
WIRE 80 640 80 432
WIRE -288 736 -288 624
WIRE 80 736 80 720
WIRE 80 736 -288 736
WIRE 80 752 80 736
WIRE -368 848 -368 608
WIRE -368 848 -400 848
WIRE 80 848 80 832
WIRE 80 848 -368 848
WIRE 176 848 176 624
WIRE 176 848 80 848
WIRE 304 848 304 688
WIRE 304 848 176 848
WIRE 704 848 704 544
WIRE 704 848 304 848
WIRE -48 976 -80 976
WIRE 64 976 32 976
WIRE 128 976 64 976
WIRE 240 976 208 976
WIRE -944 1040 -944 128
WIRE -80 1040 -80 976
WIRE -80 1040 -944 1040
WIRE 240 1040 240 976
WIRE 1504 1040 1504 208
WIRE 1504 1040 240 1040
WIRE -80 1104 -80 1040
WIRE -48 1104 -80 1104
WIRE 128 1104 16 1104
WIRE 240 1104 240 1040
WIRE 240 1104 208 1104
WIRE 176 1216 112 1216
WIRE 288 1216 256 1216
WIRE 320 1216 288 1216
WIRE 288 1232 288 1216
WIRE 112 1360 112 1216
WIRE 336 1360 192 1360
WIRE 400 1360 400 1216
FLAG -400 848 0
FLAG -384 -208 0
FLAG -384 -400 VDD1
FLAG 704 48 VDD1
FLAG -224 -208 0
FLAG -224 -400 VDD
FLAG -288 48 VDD
FLAG 48 -208 0
FLAG -368 352 0
FLAG 400 -208 0
FLAG 400 -400 Vin2
FLAG 1072 480 0
FLAG 816 336 Vo1
FLAG 688 -512 0
FLAG 1424 -736 0
FLAG 1696 -416 0
FLAG 1792 -624 Vss
FLAG 1792 -688 5V
FLAG 1248 -880 5V
FLAG 1168 -672 Vss
FLAG 1920 -656 VoscComp
FLAG 1072 -848 0
FLAG -496 -208 0
FLAG -496 -400 Vss
FLAG 1168 -848 5V
FLAG 1168 -784 5V
FLAG -288 144 Vin1
FLAG 64 1040 0
FLAG -848 96 0
FLAG -656 112 V_error
FLAG -768 80 Vss
FLAG -768 144 5V
FLAG -432 96 Vin1
FLAG -432 -32 5V
FLAG -512 176 Vss
FLAG -512 64 5V
FLAG -1264 -16 0
FLAG -1184 -32 Vss
FLAG -1184 32 5V
FLAG 1248 -16 0
FLAG -656 48 0
FLAG -560 80 VoscComp
FLAG 288 1296 0
FLAG -1440 416 0
SYMBOL IRS20954 -128 336 R0
SYMATTR InstName X1
SYMBOL cap 160 256 R0
SYMATTR InstName C1
SYMATTR Value 22n
SYMBOL voltage 48 -368 R0
WINDOW 0 -44 41 Bottom 2
WINDOW 3 147 94 Right 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V1
SYMATTR Value PULSE(-5 5 0 1n 1n 5u 20u)
SYMBOL cap -384 256 R0
SYMATTR InstName Ct1
SYMATTR Value 10p
SYMBOL voltage -224 -368 R0
SYMATTR InstName V2
SYMATTR Value 15
SYMBOL cap 160 560 R0
SYMATTR InstName C2
SYMATTR Value 30n
SYMBOL nmos 656 160 R0
SYMATTR InstName M1
SYMATTR Value irf630
SYMATTR Prefix X
SYMBOL nmos 656 448 R0
SYMATTR InstName M2
SYMATTR Value irf630
SYMATTR Prefix X
SYMBOL zener 288 352 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value MUR460
SYMBOL voltage 304 592 R0
SYMATTR InstName V3
SYMATTR Value 15
SYMBOL res 256 160 R0
SYMATTR InstName RD1
SYMATTR Value 10
SYMBOL res 576 224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RG1
SYMATTR Value 2.2
SYMBOL res 576 512 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RG2
SYMATTR Value 2.2
SYMBOL res 64 176 R0
SYMATTR InstName R1
SYMATTR Value 4.6k
SYMBOL res 192 32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 5.4k
SYMBOL res 288 160 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R3
SYMATTR Value 10k
SYMBOL diode 480 64 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value BAV21W
SYMBOL voltage -384 -368 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 60
SYMBOL res -384 512 R0
SYMATTR InstName R4
SYMATTR Value 4k
SYMBOL res -384 416 R0
SYMATTR InstName R5
SYMATTR Value 6k
SYMBOL res 64 624 R0
SYMATTR InstName R6
SYMATTR Value 3.3k
SYMBOL res 64 736 R0
SYMATTR InstName R7
SYMATTR Value 8.2k
SYMBOL voltage 400 -368 R0
WINDOW 0 -44 41 Bottom 2
WINDOW 3 147 94 Right 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V6
SYMATTR Value PULSE(5 -5 0 1n 1n 5u 20u)
SYMBOL ind 880 352 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 500µ
SYMBOL cap 1056 368 R0
SYMATTR InstName C5
SYMATTR Value 1µ
SYMBOL res 1248 320 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value {RL}
SYMBOL res 832 -800 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value {R}
SYMBOL res 832 -592 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value {R}
SYMBOL res 1120 -464 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RF1
SYMATTR Value {R}
SYMBOL res 1536 -624 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R18
SYMATTR Value {R}
SYMBOL res 1600 -752 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value {R}
SYMBOL res 1888 -560 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value {R}
SYMBOL cap 1680 -528 R0
SYMATTR InstName C7
SYMATTR Value 0.5n
SYMBOL res 1856 -832 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R21
SYMATTR Value {R}
SYMBOL opamp2 1792 -720 R0
SYMATTR InstName U1
SYMATTR Value TL084
SYMBOL opamp2 1168 -816 R0
SYMATTR InstName U2
SYMATTR Value LM393
SYMBOL res 1232 -896 R0
SYMATTR InstName R22
SYMATTR Value 3k
SYMBOL voltage 1168 -848 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V7
SYMATTR Value 5
SYMBOL voltage -496 -368 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V8
SYMATTR Value -5
SYMBOL voltage -1440 192 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -62 96 Left 2
SYMATTR Value PULSE(0 1 0.3m 0.1u 0.1u 1m 2m 1)
SYMATTR InstName V5
SYMBOL voltage -944 -112 R270
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V9
SYMATTR Value PULSE(0 0.3 0.06m 0.01u 0.01u 1)
SYMBOL res 48 960 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 100k
SYMBOL res 224 960 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 500k
SYMBOL cap 80 1040 R180
WINDOW 0 -40 46 Left 2
WINDOW 3 -37 26 Left 2
SYMATTR InstName C3
SYMATTR Value 100p
SYMBOL cap 16 1088 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value 100p
SYMBOL res 224 1088 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 10k
SYMBOL res -720 208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rp
SYMATTR Value {Rp}
SYMBOL res -800 448 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rs
SYMATTR Value {Rs}
SYMBOL cap -688 448 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName Cs
SYMATTR Value {Cs}
SYMBOL cap -736 336 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName Cp
SYMATTR Value {Cparal}
SYMBOL opamp2 -768 176 M180
SYMATTR InstName U4
SYMATTR Value TL084
SYMBOL opamp2 -512 32 R0
SYMATTR InstName U5
SYMATTR Value LM393
SYMBOL res -448 -48 R0
SYMATTR InstName R14
SYMATTR Value 3k
SYMBOL res -1120 112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value {Rg}
SYMBOL res -1312 112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R23
SYMATTR Value {Rg}
SYMBOL res -960 112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R24
SYMATTR Value {Rg}
SYMBOL opamp2 -1184 64 M180
SYMATTR InstName U3
SYMATTR Value TL084
SYMBOL voltage 1248 -112 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V10
SYMATTR Value SINE(0 1 500)
SYMBOL ind 1088 48 R0
SYMATTR InstName L2
SYMATTR Value 1000
SYMBOL cap 1200 -160 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C9
SYMATTR Value 1000
SYMBOL voltage -656 -96 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 369 69 Right 2
WINDOW 0 42 39 Left 2
SYMATTR Value PULSE(-0.3 0.3 0.06m 1m 1m 0 2m)
SYMATTR InstName V11
SYMBOL res 272 1200 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R_2
SYMATTR Value 90k
SYMBOL cap 400 1344 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C_2
SYMATTR Value 0.1n
SYMBOL res 208 1344 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R_3
SYMATTR Value 1k
SYMBOL res 416 1200 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R_1
SYMATTR Value 10k
SYMBOL cap 272 1232 R0
SYMATTR InstName C_1
SYMATTR Value 10p
TEXT -1760 -88 Left 2 ;Vb Zos: 220V\nVddZos: 210V\nVccZ: 20.2V\nVb Z: 20.2V\nVddZ: 10.4V\nTd on: 90ns+Tdt\nTd off: 90ns\nTsd:  < 1us\nTr on: 15ns\nTf off: 10ns\nTdt: 15/25/35/45ns\nVdt: .89/.57/.36/.23\nVHin: 2.3\nVLin: 1.5\nVHsat: 1.2\nRos: 5e6\nRb: 12k\nRcc: 7k\nRdd: 22k\nRin: 1e6\nUVL Vcc: 8.9/8.7V\nUVL Vb:  8.5/8.3V\nUVL Vdd: 8.7/8.2V\nIo+: 1.0A\nIo-: 1.2A\nVoc: 70/30 %Vdd\nIoc: +/-100ua\nOCH: 1.2Vos\n 300ns filter\nOCL: 0.0Vos\n 200ns filter
TEXT -1568 -376 Left 2 !.tran 0 10.5m 0.001m
TEXT -1568 -344 Left 2 !.include irf630.lib.txt
TEXT -1560 -248 Left 2 !.model MUR460 D(Is=149n Rs=.0384 N=2 EG=1.285 XTI=.5 BV=800 \n+ IBV=1e-05 Cjo=126.4p Vj=1.34 M=.52 tt=44.4n Iave=4 Vpk=600 mfg=GI type=silicon)
TEXT -1552 -184 Left 2 !.MODEL BAV21W D  ( IS=1.09u RS=0.105 BV=200 IBV=100n\n+ CJO=5.00p  M=0.333 N=3.29 TT=72.0n )
TEXT 744 -168 Left 2 !.ic V(Vo1)=-1
TEXT 752 -128 Left 2 !.ic V(Vo2)=-1
TEXT 1448 -272 Left 2 !.params R=15k
TEXT 1656 -272 Left 2 ;Con 15kOhm consigo 100k
TEXT -1168 -384 Left 2 !.include LM393.5_1
TEXT -1168 -344 Left 2 !.include TL084.301
TEXT 1112 584 Left 2 !;.step param RL list 400m 200
TEXT 1112 624 Left 2 !.param RL=8
TEXT 1088 544 Left 2 ;Siempre uno comentado y el otro no:
TEXT -1560 -424 Left 2 !;.tran 0 32.1m 0.1m
TEXT 368 304 Left 2 ;R1=4.6k
TEXT -56 904 Left 2 ;Con: R7=8.2k, R6=3.3k (dead time=15ns)\nCon: R7=2.2k y R6=5.7k (dead time=35ns)
TEXT 896 672 Left 2 ;L=250u --> si RL=400m, f0=360Hz :'(\n                  si RL=200, f0=180kHz :'(
TEXT 768 752 Left 2 ;Calculo el C para 50Hz, RL=8ohm --> C=1/(w0*RL*sqrt(2))= 280nF
TEXT 808 832 Left 2 ;Puse un C mas grande, de 1uF, porque mejora rta
TEXT 432 1144 Left 2 ;En bajas quiero ganancia tal que se iguale la\namplitud de salida con la de entrada (al nodo)
TEXT -1296 352 Left 2 !.param Rg=10k
TEXT -1336 392 Left 2 !;.step param Rg list 1k 10k
TEXT -1320 472 Left 2 ;Rg tipo 5k o 10k, ayuda a \nmatar ruido de 10kHz
TEXT -920 528 Left 2 !;.step param Rp list 25k 35k
TEXT -864 600 Left 2 !.param Cparal=10p
TEXT -904 632 Left 2 !.param Rp=100k ;valor para el cual empieza\n;a oscilar
TEXT -904 736 Left 2 !.param Cs=1p
TEXT -880 792 Left 2 !.param Rs=1Meg
