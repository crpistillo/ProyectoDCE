Version 4
SHEET 1 1964 2416
WIRE 768 -128 64 -128
WIRE -1616 -64 -1664 -64
WIRE -1520 -48 -1552 -48
WIRE -1616 -32 -1648 -32
WIRE -560 -32 -704 -32
WIRE 64 -16 64 -128
WIRE 64 -16 -144 -16
WIRE 112 -16 64 -16
WIRE 432 -16 336 -16
WIRE 448 -16 432 -16
WIRE 624 -16 528 -16
WIRE 832 -16 624 -16
WIRE 1056 -16 1056 -256
WIRE 1056 -16 896 -16
WIRE 624 0 624 -16
WIRE -560 32 -560 -32
WIRE -528 32 -560 32
WIRE -1072 48 -1104 48
WIRE -416 48 -416 0
WIRE -416 48 -464 48
WIRE -240 48 -416 48
WIRE -928 64 -1008 64
WIRE -768 64 -928 64
WIRE -528 64 -768 64
WIRE -1808 80 -2048 80
WIRE -1648 80 -1648 -32
WIRE -1648 80 -1728 80
WIRE -1616 80 -1648 80
WIRE -1520 80 -1520 -48
WIRE -1520 80 -1536 80
WIRE -1456 80 -1520 80
WIRE -1264 80 -1376 80
WIRE -1168 80 -1264 80
WIRE -1072 80 -1168 80
WIRE -240 80 -240 48
WIRE -144 80 -240 80
WIRE 112 80 -144 80
WIRE 528 80 336 80
WIRE 624 80 528 80
WIRE 1056 96 1056 -16
WIRE -496 128 -496 80
WIRE 432 128 432 -16
WIRE 624 144 624 80
WIRE -1168 176 -1168 80
WIRE -1088 176 -1168 176
WIRE -928 176 -928 64
WIRE -928 176 -1008 176
WIRE 112 176 -16 176
WIRE 832 176 336 176
WIRE 1008 176 912 176
WIRE -16 192 -16 176
WIRE 528 192 528 80
WIRE 1872 208 1536 208
WIRE -16 272 -16 256
WIRE 112 272 -16 272
WIRE 432 272 432 208
WIRE 432 272 336 272
WIRE 528 272 528 256
WIRE 528 272 432 272
WIRE 1056 272 1056 192
WIRE 1056 272 528 272
WIRE 1232 272 1056 272
WIRE 1360 272 1232 272
WIRE 1536 272 1536 208
WIRE 1536 272 1440 272
WIRE 1584 272 1536 272
WIRE 1696 272 1664 272
WIRE -16 288 -16 272
WIRE 624 288 624 224
WIRE -1168 304 -1168 176
WIRE -1072 304 -1168 304
WIRE -928 304 -928 176
WIRE -928 304 -1008 304
WIRE 1536 304 1536 272
WIRE 112 368 -16 368
WIRE 432 368 336 368
WIRE 528 368 432 368
WIRE 624 368 624 352
WIRE 624 368 528 368
WIRE 768 368 768 -128
WIRE 768 368 624 368
WIRE 1056 384 1056 272
WIRE 1056 400 1056 384
WIRE 1536 400 1536 368
WIRE 1696 400 1696 272
WIRE 1696 400 1536 400
WIRE 1536 416 1536 400
WIRE -16 464 -16 448
WIRE 112 464 -16 464
WIRE 832 464 336 464
WIRE 1008 464 912 464
WIRE 528 480 528 368
WIRE -16 528 -16 464
WIRE 112 560 64 560
WIRE 528 560 528 544
WIRE 528 560 336 560
WIRE 432 576 432 368
WIRE -2048 608 -2048 480
WIRE 64 672 64 560
WIRE 432 672 432 656
WIRE 432 672 64 672
WIRE 432 688 432 672
WIRE -16 784 -16 608
WIRE 432 784 432 768
WIRE 432 784 -16 784
WIRE 528 784 528 560
WIRE 528 784 432 784
WIRE 1056 784 1056 480
WIRE 1056 784 528 784
WIRE -2048 816 -2048 768
WIRE -1936 816 -1936 768
WIRE -1776 816 -1776 768
WIRE -1616 816 -1616 768
WIRE -2048 960 -2048 896
WIRE -1936 960 -1936 896
WIRE -1776 960 -1776 896
WIRE -1616 960 -1616 896
WIRE 464 1200 432 1200
WIRE 576 1200 544 1200
WIRE 688 1200 576 1200
WIRE 800 1200 768 1200
WIRE 576 1232 576 1200
WIRE -1264 1296 -1264 80
WIRE 432 1296 432 1200
WIRE 432 1296 -1264 1296
WIRE 800 1296 800 1200
WIRE 960 1296 800 1296
WIRE 1872 1296 1872 208
WIRE 1872 1296 960 1296
WIRE 576 1328 576 1296
WIRE 432 1376 432 1296
WIRE 464 1376 432 1376
WIRE 688 1376 528 1376
WIRE 800 1376 800 1296
WIRE 800 1376 768 1376
WIRE -848 1856 -960 1856
WIRE -624 1856 -768 1856
WIRE -1872 1888 -2048 1888
WIRE -1488 1888 -1792 1888
WIRE -1488 1904 -1488 1888
WIRE -1472 1904 -1488 1904
WIRE -1360 1920 -1360 1872
WIRE -1360 1920 -1408 1920
WIRE -1296 1920 -1360 1920
WIRE -1472 1936 -1712 1936
WIRE -1104 1936 -1184 1936
WIRE -960 1936 -960 1856
WIRE -960 1936 -1024 1936
WIRE -1440 2000 -1440 1952
WIRE -960 2000 -960 1936
WIRE -848 2000 -960 2000
WIRE -624 2016 -624 1856
WIRE -624 2016 -784 2016
WIRE -432 2016 -624 2016
WIRE -1296 2032 -1296 1920
WIRE -1056 2032 -1296 2032
WIRE -912 2032 -976 2032
WIRE -848 2032 -912 2032
WIRE -1872 2096 -1920 2096
WIRE -1712 2096 -1712 1936
WIRE -1712 2096 -1792 2096
WIRE -912 2128 -912 2032
WIRE -816 2128 -912 2128
WIRE -624 2128 -624 2016
WIRE -624 2128 -736 2128
WIRE -912 2144 -912 2128
WIRE -1920 2160 -1920 2096
WIRE -1712 2224 -1712 2096
WIRE -1584 2224 -1712 2224
WIRE -1296 2224 -1296 2032
WIRE -1296 2224 -1504 2224
WIRE -912 2256 -912 2208
WIRE -2048 2288 -2048 1888
WIRE -624 2288 -624 2128
WIRE -624 2288 -2048 2288
FLAG 1056 -256 VDD_60
FLAG -144 -16 VDD
FLAG -16 288 0
FLAG 1232 272 Vo1
FLAG -144 80 PWM
FLAG 1536 416 0
FLAG 576 1328 0
FLAG 960 1296 Vo
FLAG -768 64 V_error
FLAG -1040 32 Vss
FLAG -1040 96 5V
FLAG -416 -80 5V
FLAG -496 128 Vss
FLAG -496 16 5V
FLAG -1664 -64 0
FLAG -1584 -80 Vss
FLAG -1584 -16 5V
FLAG -704 -32 VoscComp
FLAG -1104 48 0
FLAG -2048 80 Vin
FLAG -2048 608 0
FLAG -2048 400 Vin
FLAG -1936 960 0
FLAG -1936 768 VDD_60
FLAG -1776 960 0
FLAG -1776 768 VDD
FLAG -2048 960 0
FLAG -2048 768 Vss
FLAG -1920 2160 0
FLAG -1184 1936 0
FLAG -912 2256 0
FLAG -816 2048 Vss
FLAG -816 1984 5V
FLAG -1360 1792 5V
FLAG -1440 2000 Vss
FLAG -432 2016 VoscComp
FLAG -1616 960 0
FLAG -1616 768 5V
FLAG -1440 1888 5V
SYMBOL IRS20954 224 272 R0
SYMATTR InstName X1
SYMBOL cap 512 192 R0
SYMATTR InstName C1
SYMATTR Value 22n
SYMBOL cap -32 192 R0
SYMATTR InstName Ct1
SYMATTR Value 10p
SYMBOL cap 512 480 R0
SYMATTR InstName C2
SYMATTR Value 22n
SYMBOL nmos 1008 96 R0
SYMATTR InstName M1
SYMATTR Value irf630
SYMATTR Prefix X
SYMBOL nmos 1008 384 R0
SYMATTR InstName M2
SYMATTR Value irf630
SYMATTR Prefix X
SYMBOL zener 640 352 R180
WINDOW 0 24 64 Left 2
WINDOW 3 -91 67 Left 2
SYMATTR InstName D1
SYMATTR Value MUR460
SYMBOL res 608 128 R0
WINDOW 0 37 25 Left 2
WINDOW 3 36 62 Left 2
SYMATTR InstName RD1
SYMATTR Value 10
SYMBOL res 928 160 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RG1
SYMATTR Value 20
SYMBOL res 928 448 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RG2
SYMATTR Value 20
SYMBOL res 416 112 R0
SYMATTR InstName R3
SYMATTR Value 4.6k
SYMBOL res 544 -32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 5.4k
SYMBOL res 640 96 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL diode 832 0 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value MUR460
SYMBOL res -32 512 R0
SYMATTR InstName R5
SYMATTR Value 4k
SYMBOL res -32 352 R0
SYMATTR InstName R4
SYMATTR Value 6k
SYMBOL res 416 560 R0
SYMATTR InstName R6
SYMATTR Value 8.2k
SYMBOL res 416 672 R0
SYMATTR InstName R7
SYMATTR Value 3.3k
SYMBOL ind 1344 288 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 1m
SYMBOL cap 1520 304 R0
SYMATTR InstName C3
SYMATTR Value 1Ä¾
SYMBOL res 1680 256 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 50
SYMBOL res 560 1184 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value {R_2}
SYMBOL res 784 1184 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value {R_1}
SYMBOL cap 592 1296 R180
WINDOW 0 -40 46 Left 2
WINDOW 3 -66 17 Left 2
SYMATTR InstName C4
SYMATTR Value {C_1}
SYMBOL cap 528 1360 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C5
SYMATTR Value {C_2}
SYMBOL res 784 1360 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value {R_3}
SYMBOL res -992 160 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rp1
SYMATTR Value {Rp}
SYMBOL cap -1008 288 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName Cp1
SYMATTR Value {Cp}
SYMBOL opamp2 -1040 128 M180
SYMATTR InstName U1
SYMATTR Value TL084
SYMBOL opamp2 -496 -16 R0
SYMATTR InstName U2
SYMATTR Value LM393
SYMBOL res -432 -96 R0
SYMATTR InstName R12
SYMATTR Value 3k
SYMBOL res -1520 64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value {Rg}
SYMBOL res -1712 64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value {Rg}
SYMBOL res -1360 64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value {Rg}
SYMBOL opamp2 -1584 16 M180
SYMATTR InstName U3
SYMATTR Value TL084
SYMBOL voltage -2048 384 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -139 131 Left 2
SYMATTR Value PULSE(0 3.2 0.5m 0.1u 0.1u 1m 2m)
SYMATTR InstName V1
SYMBOL voltage -1776 800 R0
SYMATTR InstName V2
SYMATTR Value 15
SYMBOL voltage -1936 800 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V3
SYMATTR Value 60
SYMBOL voltage -2048 800 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V4
SYMATTR Value -5
SYMBOL res -1776 1872 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value {R}
SYMBOL res -1776 2080 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value {R}
SYMBOL res -1488 2208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RF1
SYMATTR Value {R}
SYMBOL res -1072 2048 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R18
SYMATTR Value {R}
SYMBOL res -1008 1920 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value {R}
SYMBOL res -720 2112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value {R}
SYMBOL cap -928 2144 R0
SYMATTR InstName C6
SYMATTR Value 0.5n
SYMBOL res -752 1840 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R21
SYMATTR Value {R}
SYMBOL opamp2 -816 1952 R0
SYMATTR InstName U4
SYMATTR Value TL084
SYMBOL opamp2 -1440 1856 R0
SYMATTR InstName U5
SYMATTR Value LM393
SYMBOL res -1376 1776 R0
SYMATTR InstName R22
SYMATTR Value 3k
SYMBOL voltage -1616 800 R0
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V5
SYMATTR Value 5
TEXT 256 -224 Left 2 ;Half-Brige con Gate Driver
TEXT 1352 120 Left 2 ;Filtro
TEXT 408 1096 Left 2 ;Bloque realimentador f
TEXT -1872 -112 Left 2 !.param Rg=10k
TEXT -1856 -160 Left 2 ;Amplificador inversor -1/Rg
TEXT -1224 -80 Left 2 ;Amplificador realimentado por \ncorriente con compensador PID
TEXT -1160 400 Left 2 !.param Rp=10k Cp=1p
TEXT -616 -144 Left 2 ;Comparador
TEXT -1216 2240 Left 2 !.params R=15k
TEXT -1976 1680 Left 2 ;Generador de triangular de precision
TEXT -3264 304 Left 2 ;Vb Zos: 220V\nVddZos: 210V\nVccZ: 20.2V\nVb Z: 20.2V\nVddZ: 10.4V\nTd on: 90ns+Tdt\nTd off: 90ns\nTsd:  < 1us\nTr on: 15ns\nTf off: 10ns\nTdt: 15/25/35/45ns\nVdt: .89/.57/.36/.23\nVHin: 2.3\nVLin: 1.5\nVHsat: 1.2\nRos: 5e6\nRb: 12k\nRcc: 7k\nRdd: 22k\nRin: 1e6\nUVL Vcc: 8.9/8.7V\nUVL Vb:  8.5/8.3V\nUVL Vdd: 8.7/8.2V\nIo+: 1.0A\nIo-: 1.2A\nVoc: 70/30 %Vdd\nIoc: +/-100ua\nOCH: 1.2Vos\n 300ns filter\nOCL: 0.0Vos\n 200ns filter
TEXT -3256 1048 Left 2 !.include irf630.lib.txt
TEXT -3256 1120 Left 2 !.model MUR460 D(Is=149n Rs=.0384 \n+ N=2 EG=1.285 XTI=.5 BV=800 \n+ IBV=1e-05 Cjo=126.4p Vj=1.34 \n+ M=.52 tt=44.4n Iave=4 Vpk=600 \n+ mfg=GI type=silicon)
TEXT -3248 1280 Left 2 !.MODEL BAV21W D  ( IS=1.09u \n+ RS=0.105 BV=200 IBV=100n\n+ CJO=5.00p  M=0.333 N=3.29 \n+ TT=72.0n )
TEXT -3240 1392 Left 2 !.include LM393.5_1
TEXT -3240 1432 Left 2 !.include TL084.301
TEXT -3224 1520 Left 2 !.tran 1.5m
TEXT 432 1464 Left 2 !.param R_1=100k R_2=500k \n+ R_3=1k C_1=0.01n C_2=1n
TEXT 264 1280 Left 2 ;If
RECTANGLE Normal -92 -208 1180 840 2
RECTANGLE Normal 1288 140 1752 444 2
RECTANGLE Normal -1892 -140 -1304 176 2
RECTANGLE Normal -1224 -32 -864 436 2
RECTANGLE Normal -656 -132 -288 184 2
RECTANGLE Normal -2120 1704 -544 2348 2
RECTANGLE Normal 376 1136 864 1552 2