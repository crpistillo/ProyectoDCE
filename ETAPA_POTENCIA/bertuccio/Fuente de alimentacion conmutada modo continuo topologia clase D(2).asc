Version 4
SHEET 1 2792 680
WIRE -2544 -1872 -2576 -1872
WIRE -2432 -1872 -2464 -1872
WIRE -2368 -1872 -2432 -1872
WIRE -2256 -1872 -2288 -1872
WIRE -1888 -1872 -2256 -1872
WIRE -400 -1872 -1888 -1872
WIRE -576 -1808 -1776 -1808
WIRE -1888 -1776 -1888 -1872
WIRE -1776 -1776 -1776 -1808
WIRE -1216 -1776 -1376 -1776
WIRE -1088 -1776 -1216 -1776
WIRE -992 -1776 -1088 -1776
WIRE -960 -1776 -992 -1776
WIRE -2576 -1744 -2576 -1872
WIRE -2544 -1744 -2576 -1744
WIRE -2368 -1744 -2480 -1744
WIRE -2256 -1744 -2256 -1872
WIRE -2256 -1744 -2288 -1744
WIRE -1216 -1744 -1216 -1776
WIRE -1088 -1744 -1088 -1776
WIRE -1376 -1712 -1376 -1776
WIRE -2032 -1664 -2128 -1664
WIRE -1776 -1664 -1776 -1696
WIRE -1776 -1664 -1952 -1664
WIRE -1632 -1664 -1776 -1664
WIRE -992 -1664 -992 -1776
WIRE -1504 -1648 -1568 -1648
WIRE -1488 -1648 -1504 -1648
WIRE -1888 -1632 -1888 -1696
WIRE -1664 -1632 -1888 -1632
WIRE -1632 -1632 -1664 -1632
WIRE -2128 -1616 -2128 -1664
WIRE -1216 -1616 -1216 -1664
WIRE -1088 -1616 -1088 -1680
WIRE -1088 -1616 -1216 -1616
WIRE -1056 -1616 -1088 -1616
WIRE -2800 -1600 -2800 -1616
WIRE -1888 -1600 -1888 -1632
WIRE -1776 -1600 -1776 -1664
WIRE -2832 -1584 -2896 -1584
WIRE -2736 -1568 -2768 -1568
WIRE -1376 -1568 -1376 -1632
WIRE -1280 -1568 -1376 -1568
WIRE -2832 -1552 -2896 -1552
WIRE -992 -1552 -992 -1568
WIRE -2800 -1520 -2800 -1536
WIRE -1664 -1520 -1664 -1632
WIRE -1616 -1520 -1664 -1520
WIRE -1488 -1520 -1488 -1648
WIRE -1488 -1520 -1536 -1520
WIRE -1440 -1520 -1488 -1520
WIRE -2128 -1488 -2128 -1536
WIRE -1888 -1488 -1888 -1520
WIRE -1776 -1488 -1776 -1520
WIRE -2432 -1456 -2480 -1456
WIRE -2320 -1456 -2368 -1456
WIRE -1488 -1456 -1488 -1520
WIRE -1488 -1456 -2256 -1456
WIRE -1376 -1440 -1376 -1472
WIRE -1376 -1440 -1408 -1440
WIRE -3088 -1408 -3152 -1408
WIRE -3024 -1408 -3088 -1408
WIRE -2896 -1408 -2896 -1552
WIRE -2896 -1408 -2944 -1408
WIRE -2848 -1408 -2896 -1408
WIRE -2736 -1408 -2736 -1568
WIRE -2736 -1408 -2768 -1408
WIRE -2688 -1408 -2736 -1408
WIRE -2576 -1408 -2576 -1744
WIRE -2576 -1408 -2608 -1408
WIRE -2480 -1408 -2480 -1456
WIRE -2480 -1408 -2576 -1408
WIRE -1216 -1408 -1216 -1520
WIRE -1216 -1408 -2480 -1408
WIRE -3152 -1392 -3152 -1408
WIRE -992 -1392 -992 -1408
WIRE -3152 -1296 -3152 -1312
WIRE -912 -1296 -912 -1328
WIRE -800 -1296 -912 -1296
WIRE -2480 -1280 -2528 -1280
WIRE -2336 -1264 -2416 -1264
WIRE -2160 -1264 -2240 -1264
WIRE -2032 -1264 -2160 -1264
WIRE -912 -1264 -912 -1296
WIRE -800 -1264 -800 -1296
WIRE -2576 -1248 -2576 -1408
WIRE -2480 -1248 -2576 -1248
WIRE -1888 -1248 -1968 -1248
WIRE -2240 -1232 -2240 -1264
WIRE -2032 -1232 -2128 -1232
WIRE -1072 -1184 -1344 -1184
WIRE -960 -1184 -992 -1184
WIRE -2576 -1152 -2576 -1248
WIRE -2544 -1152 -2576 -1152
WIRE -2336 -1152 -2336 -1264
WIRE -2336 -1152 -2464 -1152
WIRE -2848 -1136 -2848 -1184
WIRE -2736 -1136 -2736 -1184
WIRE -2128 -1136 -2128 -1232
WIRE -576 -1136 -576 -1808
WIRE -400 -1136 -400 -1872
WIRE -2576 -1072 -2576 -1152
WIRE -2480 -1072 -2576 -1072
WIRE -2336 -1072 -2336 -1152
WIRE -2336 -1072 -2416 -1072
WIRE -912 -1056 -912 -1168
WIRE -912 -1056 -1088 -1056
WIRE -800 -1056 -800 -1200
WIRE -800 -1056 -912 -1056
WIRE -736 -1056 -800 -1056
WIRE -576 -1056 -576 -1136
WIRE -576 -1056 -656 -1056
WIRE -528 -1056 -576 -1056
WIRE -400 -1056 -400 -1136
WIRE -400 -1056 -448 -1056
WIRE -304 -1056 -400 -1056
WIRE -224 -1056 -304 -1056
WIRE -2848 -1024 -2848 -1056
WIRE -2736 -1024 -2736 -1056
WIRE -2736 -1024 -2848 -1024
WIRE -576 -1024 -576 -1056
WIRE -400 -1024 -400 -1056
WIRE -224 -1024 -224 -1056
WIRE -2848 -1008 -2848 -1024
WIRE -2240 -1008 -2240 -1152
WIRE -2128 -1008 -2128 -1056
WIRE -2576 -992 -2576 -1072
WIRE -2544 -992 -2576 -992
WIRE -2432 -992 -2464 -992
WIRE -2336 -992 -2336 -1072
WIRE -2336 -992 -2368 -992
WIRE -2736 -976 -2736 -1024
WIRE -800 -960 -800 -1056
WIRE -912 -944 -912 -1056
WIRE -576 -912 -576 -960
WIRE -400 -912 -400 -960
WIRE -1968 -896 -2016 -896
WIRE -1648 -896 -1744 -896
WIRE -1632 -896 -1648 -896
WIRE -1456 -896 -1552 -896
WIRE -224 -896 -224 -944
WIRE -2848 -880 -2848 -928
WIRE -1456 -880 -1456 -896
WIRE -1072 -864 -1264 -864
WIRE -960 -864 -992 -864
WIRE -800 -832 -800 -960
WIRE -1968 -800 -2016 -800
WIRE -1552 -800 -1744 -800
WIRE -1456 -800 -1552 -800
WIRE -1456 -768 -1456 -800
WIRE -1648 -752 -1648 -896
WIRE -912 -720 -912 -848
WIRE -800 -720 -800 -768
WIRE -800 -720 -912 -720
WIRE -1968 -704 -2096 -704
WIRE -1344 -704 -1344 -1184
WIRE -1344 -704 -1744 -704
WIRE -2096 -688 -2096 -704
WIRE -1552 -688 -1552 -800
WIRE -912 -672 -912 -720
WIRE -1456 -656 -1456 -688
WIRE -2096 -608 -2096 -624
WIRE -1968 -608 -2096 -608
WIRE -1648 -608 -1648 -672
WIRE -1648 -608 -1744 -608
WIRE -1552 -608 -1552 -624
WIRE -1552 -608 -1648 -608
WIRE -2096 -592 -2096 -608
WIRE -1648 -544 -1648 -608
WIRE -1088 -544 -1088 -1056
WIRE -1088 -544 -1648 -544
WIRE -1968 -512 -2096 -512
WIRE -1648 -512 -1744 -512
WIRE -1552 -512 -1648 -512
WIRE -1456 -512 -1456 -592
WIRE -1456 -512 -1552 -512
WIRE -1424 -512 -1456 -512
WIRE -2096 -416 -2096 -432
WIRE -1968 -416 -2096 -416
WIRE -1264 -416 -1264 -864
WIRE -1264 -416 -1744 -416
WIRE -1552 -384 -1552 -512
WIRE -1424 -336 -1424 -512
WIRE -1968 -320 -2016 -320
WIRE -1552 -320 -1744 -320
WIRE -1648 -304 -1648 -512
WIRE -2016 -208 -2016 -320
WIRE -1648 -208 -1648 -224
WIRE -1648 -208 -2016 -208
WIRE -1648 -192 -1648 -208
WIRE -2096 -96 -2096 -336
WIRE -2096 -96 -2128 -96
WIRE -1648 -96 -1648 -112
WIRE -1648 -96 -2096 -96
WIRE -1552 -96 -1552 -320
WIRE -1552 -96 -1648 -96
WIRE -1424 -96 -1424 -256
WIRE -1424 -96 -1552 -96
FLAG -2848 -1184 15V
FLAG -2736 -976 0
FLAG -2848 -880 -15V
FLAG -912 -1328 V+
FLAG -576 -912 0
FLAG -2128 -1008 0
FLAG -3152 -1296 0
FLAG -912 -672 0
FLAG -2000 -1216 15V
FLAG -2000 -1280 -15V
FLAG -400 -1136 Vo
FLAG -576 -1136 Vf
FLAG -3088 -1408 VrefV
FLAG -2736 -1184 V+
FLAG -304 -1056 V_salida
FLAG -1776 -1488 0
FLAG -1888 -1488 0
FLAG -1504 -1648 VerrorC
FLAG -1600 -1616 15V
FLAG -1600 -1680 -15V
FLAG -2448 -1232 15V
FLAG -2448 -1296 -15V
FLAG -2800 -1520 15V
FLAG -2800 -1616 -15V
FLAG -2896 -1584 0
FLAG -2528 -1280 0
FLAG -400 -912 0
FLAG -2128 -1232 V_triang
FLAG -2160 -1264 V_error
FLAG -2432 -1808 0
FLAG -2128 -1488 0
FLAG -2128 -1664 V_limite_C
FLAG -960 -1776 15V
FLAG -1408 -1440 -15V
FLAG -992 -1392 0
FLAG -800 -960 PWM_out
FLAG -2128 -96 0
FLAG -2016 -896 15V
FLAG -2016 -800 Vin1
FLAG -2096 -592 0
FLAG -1888 -1248 Vin1
FLAG -224 -896 0
FLAG -2240 -1008 0
SYMBOL voltage -2848 -1152 R0
SYMATTR InstName V1
SYMATTR Value 15
SYMBOL voltage -2848 -1024 R0
SYMATTR InstName V2
SYMATTR Value 15
SYMBOL nmos -960 -944 R0
SYMATTR InstName M1
SYMATTR Value irf6665
SYMATTR Prefix X
SYMBOL nmos -960 -1264 R0
SYMATTR InstName M2
SYMATTR Value irf6665
SYMATTR Prefix X
SYMBOL ind -752 -1040 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 250µ
SYMBOL cap -592 -1024 R0
SYMATTR InstName C1
SYMATTR Value 1µ
SYMBOL Opamps\\UniversalOpamp2 -2000 -1248 M180
SYMATTR InstName U1
SYMATTR Value2 Avol=1Meg GBW=100000Meg Slew=100000Meg
SYMBOL voltage -3152 -1408 R0
WINDOW 3 45 85 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 0 45 57 Left 2
SYMATTR Value 1
SYMATTR InstName V4
SYMBOL res -976 -1200 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 10
SYMBOL res -976 -880 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 10
SYMBOL res -432 -1072 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rs
SYMATTR Value 0.1
SYMBOL voltage -2736 -1152 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 75 -79 VRight 2
SYMATTR Value PULSE(50 60 1m 1u 1u 100m 100m 1)
SYMATTR InstName V8
SYMBOL res -240 -1040 R0
WINDOW 0 -54 32 Left 2
WINDOW 3 -68 68 Left 2
SYMATTR InstName R10
SYMATTR Value 1000
SYMBOL diode -784 -1200 R180
WINDOW 0 -36 37 Left 2
WINDOW 3 -104 12 Left 2
SYMATTR InstName D1
SYMATTR Value MUR460
SYMBOL diode -784 -768 R180
WINDOW 0 -38 34 Left 2
WINDOW 3 -105 9 Left 2
SYMATTR InstName D2
SYMATTR Value MUR460
SYMBOL Opamps\\UniversalOpamp2 -1600 -1648 M180
SYMATTR InstName U4
SYMATTR Value2 Avol=1Meg GBW=100000Meg Slew=100000Meg
SYMBOL res -1792 -1792 R0
SYMATTR InstName R12
SYMATTR Value 9k
SYMBOL res -1792 -1616 R0
SYMATTR InstName R13
SYMATTR Value 1k
SYMBOL res -1904 -1792 R0
SYMATTR InstName R14
SYMATTR Value 9k
SYMBOL res -1904 -1616 R0
SYMATTR InstName R15
SYMATTR Value 1k
SYMBOL res -1520 -1536 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 90k
SYMBOL res -1936 -1680 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value 90k
SYMBOL Opamps\\UniversalOpamp2 -2448 -1264 M180
SYMATTR InstName U5
SYMATTR Value2 Avol=1Meg GBW=100000Meg Slew=100000Meg
SYMBOL Opamps\\UniversalOpamp2 -2800 -1568 M180
SYMATTR InstName U7
SYMATTR Value2 Avol=1Meg GBW=100000Meg Slew=100000Meg
SYMBOL res -2928 -1424 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 10k
SYMBOL res -2752 -1424 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 10k
SYMBOL res -2448 -1168 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 1Meg
SYMBOL res -2592 -1424 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 10k
SYMBOL cap -384 -960 R180
WINDOW 0 -40 46 Left 2
WINDOW 3 -64 7 Left 2
SYMATTR InstName C6
SYMATTR Value 10µ
SYMBOL cap -2416 -1088 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C9
SYMATTR Value 10p
SYMBOL voltage -2128 -1152 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 369 69 Right 2
WINDOW 0 42 39 Left 2
SYMATTR Value PULSE(-1 1 0 2.5u 2.5u 0 5u)
SYMATTR InstName V3
SYMBOL res -2448 -1888 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 90k
SYMBOL cap -2368 -1008 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C7
SYMATTR Value 100p
SYMBOL res -2448 -1008 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 100k
SYMBOL res -2272 -1888 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R21
SYMATTR Value 10k
SYMBOL cap -2416 -1808 R180
WINDOW 0 -40 46 Left 2
WINDOW 3 -37 26 Left 2
SYMATTR InstName C8
SYMATTR Value 1n
SYMBOL cap -2480 -1760 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C10
SYMATTR Value 1n
SYMBOL res -2272 -1760 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R23
SYMATTR Value 1k
SYMBOL voltage -2128 -1520 R180
WINDOW 0 -75 75 Left 2
WINDOW 3 -81 37 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V7
SYMATTR Value 2.5
SYMBOL npn -1280 -1616 R0
SYMATTR InstName Q1
SYMATTR Value BC547B
SYMBOL pnp -1440 -1472 M180
SYMATTR InstName Q2
SYMATTR Value BC557B
SYMBOL res -1392 -1728 R0
SYMATTR InstName R18
SYMATTR Value 100k
SYMBOL LED -1008 -1472 R0
WINDOW 0 96 18 Left 2
WINDOW 3 96 41 Left 2
SYMATTR InstName D3
SYMATTR Value NSPW500BS
SYMBOL res -1232 -1760 R0
SYMATTR InstName R7
SYMATTR Value 10k
SYMBOL pnp -1056 -1568 M180
SYMATTR InstName Q3
SYMATTR Value BC557B
SYMBOL res -1008 -1568 R0
SYMATTR InstName R22
SYMATTR Value 1k
SYMBOL cap -1072 -1680 R180
WINDOW 0 -48 48 Left 2
WINDOW 3 -51 8 Left 2
SYMATTR InstName C11
SYMATTR Value 100n
SYMBOL diode -2320 -1440 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D4
SYMATTR Value 1N4148
SYMBOL zener -2368 -1472 R90
WINDOW 0 0 22 VBottom 2
WINDOW 3 35 24 VTop 2
SYMATTR InstName D5
SYMATTR Value 1N750
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL IRS20954 -1856 -608 R0
SYMATTR InstName X1
SYMBOL cap -1568 -688 R0
SYMATTR InstName C2
SYMATTR Value 22n
SYMBOL cap -2112 -688 R0
SYMATTR InstName Ct1
SYMATTR Value 10p
SYMBOL cap -1568 -384 R0
SYMATTR InstName C3
SYMATTR Value 30n
SYMBOL zener -1440 -592 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D6
SYMATTR Value MUR460
SYMBOL voltage -1424 -352 R0
SYMATTR InstName V5
SYMATTR Value 15
SYMBOL res -1472 -784 R0
SYMATTR InstName RD1
SYMATTR Value 10
SYMBOL res -1664 -768 R0
SYMATTR InstName R1
SYMATTR Value 4.6k
SYMBOL res -1536 -912 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 5.4k
SYMBOL res -1440 -784 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R3
SYMATTR Value 10k
SYMBOL res -2112 -432 R0
SYMATTR InstName R24
SYMATTR Value 4k
SYMBOL res -2112 -528 R0
SYMATTR InstName R25
SYMATTR Value 6k
SYMBOL res -1664 -320 R0
SYMATTR InstName R26
SYMATTR Value 3.3k
SYMBOL res -1664 -208 R0
SYMATTR InstName R27
SYMATTR Value 8.2k
SYMBOL voltage -2240 -1248 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value PULSE(-0.5 0.5 0 1m 1m 0 2m)
TEXT -3160 -768 Left 2 !.model SW SW(Ron=0.001 Roff=100Meg Vt=0.5 Vh=0.25)
TEXT -3160 -808 Left 2 !.tran 0 30m 0 1u uic
TEXT -3160 -848 Left 2 !.include irf6665.spi
TEXT -3160 -712 Left 2 !.model SWC SW(Ron=0.1 Roff=100Meg Vt=0.5 Vh=0.25)
